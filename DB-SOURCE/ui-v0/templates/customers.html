{% extends "base.html" %}

{% block title %}Kontrahenci - {{ company.nazwa or company.db_name }}{% endblock %}

{% block content %}
<!-- Sidebar -->
<div class="sidebar">
    <div class="sidebar-buttons">
        <button id="changeCompanyBtn" class="btn btn-light">
            <i class="fas fa-exchange-alt"></i>
            Zmień firmę
        </button>
    </div>
</div>

<!-- Główny kontener -->
<div class="container">
    <div class="main-grid">
        <!-- Panel kontrahentów -->
        <div class="customers-panel">
            <div class="panel-header">
                <h2>Lista kontrahentów</h2>
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text"
                           id="customerSearch"
                           class="form-control"
                           placeholder="Szukaj kontrahenta..."
                           value="{{ search or '' }}"
                           autocomplete="off">
                </div>
            </div>

            <div class="customers-list">
                {% if customers_data.customers %}
                    {% for customer in customers_data.customers %}
                    <div class="customer-item"
                         data-customer-id="{{ customer.id }}"
                         data-customer-name="{{ customer.nazwa }}">
                        <div class="customer-info">
                            <h3>{{ customer.nazwa or 'Bez nazwy' }}</h3>
                            <div class="customer-details">
                                {% if customer.ulica or customer.miasto %}
                                <div class="customer-address">
                                    <i class="fas fa-map-marker-alt"></i>
                                    {{ customer.ulica or '' }}{% if customer.ulica and customer.miasto %}, {% endif %}{{ customer.miasto or '' }}
                                </div>
                                {% endif %}
                                {% if customer.nip %}
                                <div class="customer-nip">
                                    <i class="fas fa-id-card"></i>
                                    NIP: {{ customer.nip }}
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="empty-state">
                        <i class="fas fa-users"></i>
                        <h3>Brak kontrahentów</h3>
                        <p>
                            {% if search %}
                            Nie znaleziono kontrahentów pasujących do wyszukiwania: "{{ search }}"
                            {% else %}
                            Ta firma nie ma zdefiniowanych kontrahentów
                            {% endif %}
                        </p>
                    </div>
                {% endif %}
            </div>

            {% if customers_data.total_count > customers_data.per_page %}
            <div class="pagination">
                <div class="pagination-info">
                    Wyświetlanie {{ ((customers_data.current_page - 1) * customers_data.per_page) + 1 }} -
                    {{ [customers_data.current_page * customers_data.per_page, customers_data.total_count]|min }}
                    z {{ customers_data.total_count }} kontrahentów
                </div>
                <div class="pagination-controls">
                    {% if customers_data.current_page > 1 %}
                    <a href="?page={{ customers_data.current_page - 1 }}&search={{ search or '' }}" class="btn btn-outline-secondary btn-sm">
                        <i class="fas fa-chevron-left"></i> Poprzednia
                    </a>
                    {% endif %}
                    <span class="btn btn-sm btn-secondary disabled">
                        Strona {{ customers_data.current_page }}
                    </span>
                    {% if customers_data.current_page * customers_data.per_page < customers_data.total_count %}
                    <a href="?page={{ customers_data.current_page + 1 }}&search={{ search or '' }}" class="btn btn-outline-secondary btn-sm">
                        Następna <i class="fas fa-chevron-right"></i>
                    </a>
                    {% endif %}
                </div>
            </div>
            {% endif %}
        </div>

        <!-- Panel dokumentów -->
        <div class="documents-panel">
            <div class="panel-header">
                <h2>Dokumenty kontrahenta</h2>
            </div>

            <div class="documents-list">
                <div class="empty-state">
                    <i class="fas fa-hand-pointer"></i>
                    <h3>Wybierz kontrahenta</h3>
                    <p>Kliknij na kontrahenta z listy po lewej stronie, aby zobaczyć jego dokumenty</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}